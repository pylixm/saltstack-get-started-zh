# 理解 SaltStack

## 走近 salt 

你可以通过观察salt的运行来了解salt的工作方式，但是，在控制台上的数据文件可能很难注意到有许多事情发生。“入门”教程的这一部分介绍了Salt的工作原理，Salt子系统以及Salt的模块化架构如何使用，并扩展了Salt来管理整个基础架构。

在了解Salt组件的具体细节之前，了解Salt对基础设施管理方式的一些知识是有帮助的。

### 实时通讯

所有的salt minion 同时接受命令。这意味着更新10或10,000个系统所需的时间非常相似，对数千个系统的查询可以在几秒钟内完成。Salt获取基础设施信息的方式是实时查询，而不是依赖（通常是过时的）数据库。

注意：数据库非常适用于存储作业结果，Salt支持超过30个作业结果插件，包括mysql，elasticsearch，syslog，carbon和redis。 Salt为许多数据存储提供了接口和安全配置数据。当涉及到依赖于当前系统配置的决策时，Salt会将一个静态数据库看作是通过发送单独的文本消息，然后在笔记本中写出询问房间中的每个人的问题的答案。

### NO FREELOADERS（不贪图便宜，偷懒）

Salt minion 完成自己的工作。来自Salt master的通信是一组轻量级的指令，基本上说“如果你是具有这些属性的minion：用这些参数运行这个命令。”在接收到命令时，salt minions确定它们是否匹配属性。每个Salt minion都已经具有本地存储的所有命令，因此可以执行该命令，并将结果快速返回给Salt master。Salt master 不会为minion做任何事情（这样通常更好）。

### Salt 评价

Salt专为高性能和可扩展性而设计。Salt的通信系统使用ZeroMQ或原始TCP建立了Salt master和minion之间的持续数据管道，使得Salt相对于竞争解决方案具有显着的性能优势。消息可以使用MessagePack在线上有效序列化。在内部，Salt使用Python Tornado（由一些真正的智能开发人员实现）作为异步网络库，Salt通过使用前沿方法进行多线程和并发调整。

在一个单一的生产主机上满足超过10,000个用户的用户并不罕见，在单个salt master中有已知的部署超过3.5万次！(译者注：估计和服务器环境有关，实测16核16G内存的机器，单台master承载的minion数最多在1k左右，并没有3.5w这么多。) Salt已经证明了现实世界的速度和可扩展性。

### 标准化一切

规范化是Salt跨平台管理能力的关键。无论您是针对的是Linux，Windows，MacOS，FreeBSD，Solaris或AIX，都位于物理硬件或云端，或者您正在定位一个容器，则salt命令和state都是一样的。Salt提取每个操作系统，硬件类型和系统工具的详细信息，以便您可以正确地管理基础架构。

所有内容还包括返回：Salt命令返回结果，保持一致的数据结构，便于消费和存储。

### 管理一切

Salt几乎可以运行在可运行Python的所有系统。对于不能很好地运行Python的设备，您可以使用代理服务器系统。这意味着由Salt管理的唯一要求是支持任何网络协议（即使您自己编写协议）。Salt命令被发送到代理服务器，它将salt调用转换为本地协议，然后将它们发送到设备。解析来自设备的返回数据，然后放入数据结构并返回。

### 自动化一切

Salt的事件驱动式基础设施不仅可以让您自动执行初始系统配置，还可让您随时随地自动化进行扩展，修复和执行持续管理。Salt用户可自动部署和维护复杂的分布式网络应用程序和数据库，自定义应用程序，文件，用户帐户，标准软件包，云资源等等。

### 无需编程

您可以使用所有的salt功能，而无需学习编程语言。Salt的远程执行功能是CLI命令，State系统使用YAML来描述系统的所需配置。

您仍然可以采用“基础架构代码”的方法 - Salt具有许多支持这些功能的工具，包括强制性和声明式执行的强大的必需系统。Salt只是让您无需编写Python或Ruby代码来描述您的基础设施。

### 通过模块化系统的可扩展性

一些管理工具认为自己是可扩展的，因为它们可以运行外部脚本。在salt中，一切都是可扩展的。正如您将在下一节中学到的，即使是底层通信协议也是可互换的。 Salt有超过20个可扩展子系统，这意味着如果Salt可以做到这一点，那么您可以自定义如何完成。

Salt可以快速采用新技术并管理新的应用程序，因为它们是可以被二次开发的。您将永远不会受制于别人的决定，哪个才是管理您的基础设施的最佳方法。

### 插件式

在下一节中，我们将了解Salt插件，以及它们对Salt方法至关重要的原因。

## 插件式

## 通信安全

## 远程执行 

## State 系统

## Runner 

## 基础数据

## python 
